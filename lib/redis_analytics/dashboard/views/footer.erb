<!-- start footer -->

<script type="text/javascript" language="text/javascript">
visits_area = Morris.Area({
  element: 'visits_area',
  xkey: 'date',
  data: <%=@data[:week][:visits_new_visits][:plot].to_json%>,
  ykeys: ['new_visits', 'returning_visits'],
  labels: ['New Visits', 'Returning Visits'],
  ymax: 'auto 20',
  events: ['2013-03-02', '2013-03-03'],
  eventStrokeWidth: 2,
  eventLineColors: ['#ccc', '#eee'],
  smooth: true,
  hideHover: true,
  lineWidth: 2,
  pointSize: 1,
  // hoverCallback: function(index, series)
  //   {
  // 	h = series.data[index];
  // 	d = Date(h.x);
  // 	return(d + '<br>' + h.new_visits);
  //   },
  pointFillColors: ['#fff'],
  pointStrokeColors: ['#000'],
});

visits_donut = Morris.Donut({
  element: 'visits_donut',
  data: <%=@data[:week][:visits_new_visits][:donut].to_json%>
});

traffic_donut = Morris.Donut({
  element: 'traffic_donut',
  data: [{"label":"Google","value":6482},{"label":"Bing","value":2136},{"label":"Direct","value":8136},{"label":"Other","value":5136}]
});

visitor_info_donut = Morris.Donut({
  element: 'visitor_info_donut',
  data: [{"label":"Chrome","value":6482},{"label":"Firefox","value":2195},{"label":"Internet Explorer","value":8142}]
});


unique_visits_line = Morris.Bar({
  element: 'unique_visits_line',
  xkey: 'day_of_week',
  data: <%=@data[:week][:unique_visits].to_json%>,
  ykeys: ['unique_visits_this', 'unique_visits_last'],
  labels: ['This Week', 'Last Week'],
  ymax: 'auto 20',
  hideHover: 'auto',
  stacked: true
});

function changeTimeFrame(range)
{
switch(range)
{
case 'day':
    // visits_area.setData(<%=@day_visits_and_new_visits.to_json%>);
    // visits_donut.setData(<%=@day_visits_and_new_visits_donut.to_json%>);
case 'week':
    visits_area.setData(<%=@data[:week][:visits_new_visits][:plot].to_json%>);
    visits_donut.setData(<%=@data[:week][:visits_new_visits][:donut].to_json%>);
case 'month':
    visits_area.setData(<%=@data[:month][:visits_new_visits][:plot].to_json%>);
    visits_donut.setData(<%=@data[:month][:visits_new_visits][:donut].to_json%>);
    break;
}
}


var geoLocationData = {
  "IN": 3230,
  "AE": 235,
  "KW": 132,
  "QR": 109
};

$(function(){
  $('#world-map-gdp').vectorMap({
    map: 'world_mill_en',
    min: 0,
    backgroundColor: '#fff',
regionStyle: {
  initial: {
    fill: '#ddd',
    "fill-opacity": 1,
    stroke: 'none',
    "stroke-width": 0,
    "stroke-opacity": 1
  },
  hover: {
    fill: '#bbb',
    "fill-opacity": 0.8
  },
  selected: {
    fill: 'yellow'
  },
  selectedHover: {
  }
},
    series: {
      regions: [{
        scale: ['#C8EEFF', '#0071A4'],
        values: geoLocationData,
        normalizeFunction: 'polynomial'
      }]
    },
    onLabelShow: function(e, el, code){
      el.html(el.html()+' (GDP - '+geoLocationData[code]+')');
    }
  });
});
</script>
<script language="javascript" type="text/javascript" src="<%=$template_prefix%>/javascripts/bootstrap.min.js"></script>

<!-- end footer -->
